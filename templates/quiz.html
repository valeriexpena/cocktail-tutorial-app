{% extends "base.html" %}

{% block title %}Quiz: {{ cocktail_name }} - Question {{ question_id }}{% endblock %}

{% block content %}

<body>
  <h1>Quiz: {{ cocktail_name }}</h1>
  <h2>Question {{ question_id }}</h2>
  <p>{{ question["question"] }}</p>

  <form method="POST" action="/cocktail/{{ drink_id }}/quiz/{{ question_id }}">
    {% if question["type"] == "multiple-choice" or question["type"] == "checkbox" %}
    {% for option in question["options"] %}
    <label>
      <input type="{{ 'checkbox' if question['type'] == 'checkbox' else 'radio' }}" name="answer" value="{{ option }}"
        onchange="enableShowAnswer()">
      {{ option }}
    </label><br>
    {% endfor %}

    {% elif question["type"] == "drag-timer" %}
    <p> This is a drag-timer question.<br>
      Target Time: {{ question["correct"] }}s ±{{ question["tolerance"] }}s</p>
    <label>How many seconds did you hold it for?
      <input type="number" name="answer"
        onchange="validateDragTimer(this, {{ question['correct'] }}, {{ question['tolerance'] }})">
    </label>

    {% elif question["type"] == "drag-quantity" %}
    <p> Drag {{ question["correct"] }} items to the correct spot.</p>
    <label>How many items did you drag?
      <input type="number" name="answer" onchange="validateDragQuantity(this, {{ question['target'] }})">
    </label>

    {% elif question["type"] == "drag-select" %}
    <p>Drag the correct option into the drop area.</p>
    <div id="drag-options">
      {% for option in question["options"] %}
      <div class="draggable-option" draggable="true"
        ondragstart="event.dataTransfer.setData('text/plain', '{{ option }}')">
        {{ option }}
      </div>
      {% endfor %}
    </div>
    <div id="drop-area" ondragover="event.preventDefault()" ondrop="handleDrop(event)"
      style="border: 2px dashed #ccc; padding: 20px; margin-top: 10px;">
      Drop here
    </div>
    <input type="hidden" name="answer" id="drag-select-answer">
    {% endif %}

    <br><br>
    <button type="button" id="show-answer" onclick="showAnswer()" disabled>Show Answer</button>
    <button type="button" id="next-button" onclick="navigateToNextQuestion()" disabled>Next</button>
  </form>

  <div id="answer-section" style="display: none;">
    <h3>Correct Answer:</h3>
    <p>
      {% if question["type"] == "multiple-choice" or question["type"] == "checkbox" %}
      {{ question["correct"] | join(", ") }}
      {% elif question["type"] == "drag-timer" %}
      {{ question["correct"] }}s ±{{ question["tolerance"] }}s
      {% elif question["type"] == "drag-quantity" %}
      {{ question["correct"] }} items
      {% elif question["type"] == "drag-select" %}
      {{ question["correct"] }}
      {% endif %}
    </p>
  </div>
  <script src="{{ url_for('static', filename='quiz.js') }}"></script>
</body>

{% endblock %}